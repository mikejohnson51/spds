<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Geography 176A</title>
    <meta charset="utf-8" />
    <meta name="author" content="Mike Johnson" />
    <script src="libs/header-attrs-2.3/header-attrs.js"></script>
    <link rel="stylesheet" href="ucsb.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Geography 176A
## Lecture 06: Data Visualization
### Mike Johnson

---


&lt;style type="text/css"&gt;
.remark-code{line-height: 2; font-size: 80%}
&lt;/style&gt;


# Picking back up!

---

# Table Functions:

- **select()** _Select relevant columns of your data_
- **filter()**	_Filter your data according to logical statements_
- **arrange()**	_Sort your data on a certain column_
- **mutate()**	_Create new variables and add them to your dataset_
- **rename()**	_Rename the columns of your data_

--

# Split-apply

**group_by()** _declare subsets in data_
**summarize()** _summarize the data, by groups if they have been declared_

--

# The "glue"

The pipe **%&gt;%** is used to feed in the output that precedes it.

---

**Operators**  
`+`	plus  
`-`	minus  
`*`	multiplication  
`/`	division  
`^`	exponential  

--

**Logical Operator**  
`==`	equal, tests equality  
`!=`	not equal, tests inequality  
`&gt;` greater than, tests greater than (also &gt;=)  
`&lt;`	less than, tests less than (also &lt;=)  
`%in%`	contains, tests inclusion  
`&amp;`	and, returns true if preceeding and following are both true, else FALSE   
`|`	or, returns true if either preceeding and following are true, else FALSE    

--

**Function**  
max()  
min()  
sum()  
custom ...  
 
---

# Yesterdays Assignment


```r
library(tidyverse)
url = 'https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv'
covid = read_csv(url)
head(covid)
```

```
# A tibble: 6 x 6
  date       county    state      fips  cases deaths
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 2020-01-21 Snohomish Washington 53061     1      0
2 2020-01-22 Snohomish Washington 53061     1      0
3 2020-01-23 Snohomish Washington 53061     1      0
4 2020-01-24 Cook      Illinois   17031     1      0
5 2020-01-24 Snohomish Washington 53061     1      0
6 2020-01-25 Orange    California 06059     1      0
```

---
count: false
 
# Question 1: Counties with most cases
.left-panel-q1-auto[

```r
*covid
```
]
 
.right-panel-q1-auto[

```
# A tibble: 421,390 x 6
   date       county      state      fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-01-21 Snohomish   Washington 53061     1      0
 2 2020-01-22 Snohomish   Washington 53061     1      0
 3 2020-01-23 Snohomish   Washington 53061     1      0
 4 2020-01-24 Cook        Illinois   17031     1      0
 5 2020-01-24 Snohomish   Washington 53061     1      0
 6 2020-01-25 Orange      California 06059     1      0
 7 2020-01-25 Cook        Illinois   17031     1      0
 8 2020-01-25 Snohomish   Washington 53061     1      0
 9 2020-01-26 Maricopa    Arizona    04013     1      0
10 2020-01-26 Los Angeles California 06037     1      0
# … with 421,380 more rows
```
]

---
count: false
 
# Question 1: Counties with most cases
.left-panel-q1-auto[

```r
covid %&gt;%  
* filter(date == max(date))
```
]
 
.right-panel-q1-auto[

```
# A tibble: 3,221 x 6
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,211 more rows
```
]

---
count: false
 
# Question 1: Counties with most cases
.left-panel-q1-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
* arrange(-cases)
```
]
 
.right-panel-q1-auto[

```
# A tibble: 3,221 x 6
   date       county        state      fips   cases deaths
   &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 New York City New York   &lt;NA&gt;  232756  23586
 2 2020-08-10 Los Angeles   California 06037 210424   4996
 3 2020-08-10 Miami-Dade    Florida    12086 133622   1874
 4 2020-08-10 Maricopa      Arizona    04013 126371   2356
 5 2020-08-10 Cook          Illinois   17031 111948   4928
 6 2020-08-10 Harris        Texas      48201  86563   1583
 7 2020-08-10 Broward       Florida    12011  62898    821
 8 2020-08-10 Dallas        Texas      48113  55255    756
 9 2020-08-10 Clark         Nevada     32003  49151    811
10 2020-08-10 Suffolk       New York   36103  43844   1998
# … with 3,211 more rows
```
]

---
count: false
 
# Question 1: Counties with most cases
.left-panel-q1-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  arrange(-cases) %&gt;%  
* select(county, state, cases)
```
]
 
.right-panel-q1-auto[

```
# A tibble: 3,221 x 3
   county        state       cases
   &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt;
 1 New York City New York   232756
 2 Los Angeles   California 210424
 3 Miami-Dade    Florida    133622
 4 Maricopa      Arizona    126371
 5 Cook          Illinois   111948
 6 Harris        Texas       86563
 7 Broward       Florida     62898
 8 Dallas        Texas       55255
 9 Clark         Nevada      49151
10 Suffolk       New York    43844
# … with 3,211 more rows
```
]

---
count: false
 
# Question 1: Counties with most cases
.left-panel-q1-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  arrange(-cases) %&gt;%  
  select(county, state, cases) %&gt;%  
* head(5)
```
]
 
.right-panel-q1-auto[

```
# A tibble: 5 x 3
  county        state       cases
  &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt;
1 New York City New York   232756
2 Los Angeles   California 210424
3 Miami-Dade    Florida    133622
4 Maricopa      Arizona    126371
5 Cook          Illinois   111948
```
]

&lt;style&gt;
.left-panel-q1-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-q1-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-q1-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
*covid
```
]
 
.right-panel-q2-auto[

```
# A tibble: 421,390 x 6
   date       county      state      fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-01-21 Snohomish   Washington 53061     1      0
 2 2020-01-22 Snohomish   Washington 53061     1      0
 3 2020-01-23 Snohomish   Washington 53061     1      0
 4 2020-01-24 Cook        Illinois   17031     1      0
 5 2020-01-24 Snohomish   Washington 53061     1      0
 6 2020-01-25 Orange      California 06059     1      0
 7 2020-01-25 Cook        Illinois   17031     1      0
 8 2020-01-25 Snohomish   Washington 53061     1      0
 9 2020-01-26 Maricopa    Arizona    04013     1      0
10 2020-01-26 Los Angeles California 06037     1      0
# … with 421,380 more rows
```
]

---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
covid %&gt;%  
* filter(date == max(date))
```
]
 
.right-panel-q2-auto[

```
# A tibble: 3,221 x 6
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,211 more rows
```
]

---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
* group_by(state)
```
]
 
.right-panel-q2-auto[

```
# A tibble: 3,221 x 6
# Groups:   state [55]
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,211 more rows
```
]

---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
* summarize(cases = sum(cases, na.rm = TRUE))
```
]
 
.right-panel-q2-auto[

```
# A tibble: 55 x 2
   state                 cases
   &lt;chr&gt;                 &lt;dbl&gt;
 1 Alabama              103020
 2 Alaska                 4537
 3 Arizona              187634
 4 Arkansas              50028
 5 California           574267
 6 Colorado              51104
 7 Connecticut           50567
 8 Delaware              15634
 9 District of Columbia  12807
10 Florida              536953
# … with 45 more rows
```
]

---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(cases = sum(cases, na.rm = TRUE)) %&gt;%  
* ungroup()
```
]
 
.right-panel-q2-auto[

```
# A tibble: 55 x 2
   state                 cases
   &lt;chr&gt;                 &lt;dbl&gt;
 1 Alabama              103020
 2 Alaska                 4537
 3 Arizona              187634
 4 Arkansas              50028
 5 California           574267
 6 Colorado              51104
 7 Connecticut           50567
 8 Delaware              15634
 9 District of Columbia  12807
10 Florida              536953
# … with 45 more rows
```
]

---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(cases = sum(cases, na.rm = TRUE)) %&gt;%  
  ungroup() %&gt;%  
* slice_max(cases, n = 5)
```
]
 
.right-panel-q2-auto[

```
# A tibble: 5 x 2
  state       cases
  &lt;chr&gt;       &lt;dbl&gt;
1 California 574267
2 Florida    536953
3 Texas      514940
4 New York   426046
5 Georgia    202276
```
]

---
count: false
 
# Question 2: States with most cases
.left-panel-q2-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(cases = sum(cases, na.rm = TRUE)) %&gt;%  
  ungroup() %&gt;%  
  slice_max(cases, n = 5) %&gt;%  
* pull(state)
```
]
 
.right-panel-q2-auto[

```
[1] "California" "Florida"    "Texas"      "New York"   "Georgia"   
```
]

&lt;style&gt;
.left-panel-q2-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-q2-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-q2-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---

# The hidden need for ungrouping

- `ungroup()` should always be  applied after the grouping calcuations.. 
- If you forget to `ungroup()` data, future data management will likely produce errors.
-  Even if you do not plan on performing additional calculations, it’s a good habit to keep. 
- `ungroup()` is especially important when creating objects!!

--

- Think about the dimision of your data structure!

--

.pull-left[

```r
gapminder %&gt;% 
  filter(year == 2007) %&gt;% 
  group_by(continent) %&gt;% 
  mutate(mp = mean(pop)) %&gt;%   
  mutate(mle = mean(lifeExp)) %&gt;% 
* ungroup()  %&gt;%
  select(country, year, mp, mle) 
```

```
# A tibble: 142 x 4
   country      year         mp   mle
   &lt;fct&gt;       &lt;int&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Afghanistan  2007 115513752.  70.7
 2 Albania      2007  19536618.  77.6
 3 Algeria      2007  17875763.  54.8
 4 Angola       2007  17875763.  54.8
 5 Argentina    2007  35954847.  73.6
 6 Australia    2007  12274974.  80.7
 7 Austria      2007  19536618.  77.6
 8 Bahrain      2007 115513752.  70.7
 9 Bangladesh   2007 115513752.  70.7
10 Belgium      2007  19536618.  77.6
# … with 132 more rows
```
]

.pull-right[

```r
gapminder %&gt;% 
  filter(year == 2007) %&gt;% 
  group_by(continent) %&gt;%  
  mutate(mp = mean(pop)) %&gt;%  
* ungroup() %&gt;%
  mutate(mle = mean(lifeExp))  %&gt;% 
  select(country, year, mp, mle)
```

```
# A tibble: 142 x 4
   country      year         mp   mle
   &lt;fct&gt;       &lt;int&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Afghanistan  2007 115513752.  67.0
 2 Albania      2007  19536618.  67.0
 3 Algeria      2007  17875763.  67.0
 4 Angola       2007  17875763.  67.0
 5 Argentina    2007  35954847.  67.0
 6 Australia    2007  12274974.  67.0
 7 Austria      2007  19536618.  67.0
 8 Bahrain      2007 115513752.  67.0
 9 Bangladesh   2007 115513752.  67.0
10 Belgium      2007  19536618.  67.0
# … with 132 more rows
```
]

---
count: false
 
# Question 3 (1): County death ratio
.left-panel-q31-auto[

```r
*covid
```
]
 
.right-panel-q31-auto[

```
# A tibble: 421,390 x 6
   date       county      state      fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-01-21 Snohomish   Washington 53061     1      0
 2 2020-01-22 Snohomish   Washington 53061     1      0
 3 2020-01-23 Snohomish   Washington 53061     1      0
 4 2020-01-24 Cook        Illinois   17031     1      0
 5 2020-01-24 Snohomish   Washington 53061     1      0
 6 2020-01-25 Orange      California 06059     1      0
 7 2020-01-25 Cook        Illinois   17031     1      0
 8 2020-01-25 Snohomish   Washington 53061     1      0
 9 2020-01-26 Maricopa    Arizona    04013     1      0
10 2020-01-26 Los Angeles California 06037     1      0
# … with 421,380 more rows
```
]

---
count: false
 
# Question 3 (1): County death ratio
.left-panel-q31-auto[

```r
covid %&gt;%  
* filter(date == max(date))
```
]
 
.right-panel-q31-auto[

```
# A tibble: 3,221 x 6
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,211 more rows
```
]

---
count: false
 
# Question 3 (1): County death ratio
.left-panel-q31-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
* mutate(ratio = 100*(deaths/cases))
```
]
 
.right-panel-q31-auto[

```
# A tibble: 3,221 x 7
   date       county   state   fips  cases deaths ratio
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22 1.80 
 2 2020-08-10 Baldwin  Alabama 01003  3714     28 0.754
 3 2020-08-10 Barbour  Alabama 01005   631      5 0.792
 4 2020-08-10 Bibb     Alabama 01007   450      5 1.11 
 5 2020-08-10 Blount   Alabama 01009   947      4 0.422
 6 2020-08-10 Bullock  Alabama 01011   474     12 2.53 
 7 2020-08-10 Butler   Alabama 01013   782     37 4.73 
 8 2020-08-10 Calhoun  Alabama 01015  1883     17 0.903
 9 2020-08-10 Chambers Alabama 01017   909     38 4.18 
10 2020-08-10 Cherokee Alabama 01019   304      9 2.96 
# … with 3,211 more rows
```
]

---
count: false
 
# Question 3 (1): County death ratio
.left-panel-q31-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
* slice_max(ratio, n = 5)
```
]
 
.right-panel-q31-auto[

```
# A tibble: 5 x 7
  date       county  state          fips  cases deaths ratio
  &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 2020-08-10 Unknown Kansas         &lt;NA&gt;      0      6   Inf
2 2020-08-10 Unknown Maryland       &lt;NA&gt;      0     18   Inf
3 2020-08-10 Unknown South Carolina &lt;NA&gt;      0      1   Inf
4 2020-08-10 Unknown North Dakota   &lt;NA&gt;      4      4   100
5 2020-08-10 Unknown Washington     &lt;NA&gt;      2      2   100
```
]

---
count: false
 
# Question 3 (1): County death ratio
.left-panel-q31-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
  slice_max(ratio, n = 5) %&gt;%  
* pull(county)
```
]
 
.right-panel-q31-auto[

```
[1] "Unknown" "Unknown" "Unknown" "Unknown" "Unknown"
```
]

&lt;style&gt;
.left-panel-q31-auto {
  color: #777;
  width: 58.8235294117647%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-q31-auto {
  width: 39.2156862745098%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-q31-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---
count: false
 
# Question 3 (2): County death ratio
.left-panel-q32-auto[

```r
*covid
```
]
 
.right-panel-q32-auto[

```
# A tibble: 421,390 x 6
   date       county      state      fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-01-21 Snohomish   Washington 53061     1      0
 2 2020-01-22 Snohomish   Washington 53061     1      0
 3 2020-01-23 Snohomish   Washington 53061     1      0
 4 2020-01-24 Cook        Illinois   17031     1      0
 5 2020-01-24 Snohomish   Washington 53061     1      0
 6 2020-01-25 Orange      California 06059     1      0
 7 2020-01-25 Cook        Illinois   17031     1      0
 8 2020-01-25 Snohomish   Washington 53061     1      0
 9 2020-01-26 Maricopa    Arizona    04013     1      0
10 2020-01-26 Los Angeles California 06037     1      0
# … with 421,380 more rows
```
]

---
count: false
 
# Question 3 (2): County death ratio
.left-panel-q32-auto[

```r
covid %&gt;%  
* filter(date == max(date), cases &gt; 0, county != "Unknown")
```
]
 
.right-panel-q32-auto[

```
# A tibble: 3,195 x 6
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,185 more rows
```
]

---
count: false
 
# Question 3 (2): County death ratio
.left-panel-q32-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 0, county != "Unknown") %&gt;%  
* mutate(ratio = 100*(deaths/cases))
```
]
 
.right-panel-q32-auto[

```
# A tibble: 3,195 x 7
   date       county   state   fips  cases deaths ratio
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22 1.80 
 2 2020-08-10 Baldwin  Alabama 01003  3714     28 0.754
 3 2020-08-10 Barbour  Alabama 01005   631      5 0.792
 4 2020-08-10 Bibb     Alabama 01007   450      5 1.11 
 5 2020-08-10 Blount   Alabama 01009   947      4 0.422
 6 2020-08-10 Bullock  Alabama 01011   474     12 2.53 
 7 2020-08-10 Butler   Alabama 01013   782     37 4.73 
 8 2020-08-10 Calhoun  Alabama 01015  1883     17 0.903
 9 2020-08-10 Chambers Alabama 01017   909     38 4.18 
10 2020-08-10 Cherokee Alabama 01019   304      9 2.96 
# … with 3,185 more rows
```
]

---
count: false
 
# Question 3 (2): County death ratio
.left-panel-q32-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 0, county != "Unknown") %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
* slice_max(ratio, n = 5)   # see with_ties
```
]
 
.right-panel-q32-auto[

```
# A tibble: 7 x 7
  date       county       state      fips  cases deaths ratio
  &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 2020-08-10 Throckmorton Texas      48447     4      2  50  
2 2020-08-10 Perkins      Nebraska   31135    18      7  38.9
3 2020-08-10 Waldo        Maine      23027    62     14  22.6
4 2020-08-10 Morton       Kansas     20129     9      2  22.2
5 2020-08-10 Sweet Grass  Montana    30097     5      1  20  
6 2020-08-10 Catron       New Mexico 35003     5      1  20  
7 2020-08-10 Dickens      Texas      48125     5      1  20  
```
]

---
count: false
 
# Question 3 (2): County death ratio
.left-panel-q32-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 0, county != "Unknown") %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
  slice_max(ratio, n = 5) %&gt;%  # see with_ties
* pull(county)
```
]
 
.right-panel-q32-auto[

```
[1] "Throckmorton" "Perkins"      "Waldo"        "Morton"       "Sweet Grass" 
[6] "Catron"       "Dickens"     
```
]

&lt;style&gt;
.left-panel-q32-auto {
  color: #777;
  width: 58.8235294117647%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-q32-auto {
  width: 39.2156862745098%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-q32-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---
count: false
 
# Question 3 (3): County death ratio
.left-panel-q33-auto[

```r
*covid
```
]
 
.right-panel-q33-auto[

```
# A tibble: 421,390 x 6
   date       county      state      fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-01-21 Snohomish   Washington 53061     1      0
 2 2020-01-22 Snohomish   Washington 53061     1      0
 3 2020-01-23 Snohomish   Washington 53061     1      0
 4 2020-01-24 Cook        Illinois   17031     1      0
 5 2020-01-24 Snohomish   Washington 53061     1      0
 6 2020-01-25 Orange      California 06059     1      0
 7 2020-01-25 Cook        Illinois   17031     1      0
 8 2020-01-25 Snohomish   Washington 53061     1      0
 9 2020-01-26 Maricopa    Arizona    04013     1      0
10 2020-01-26 Los Angeles California 06037     1      0
# … with 421,380 more rows
```
]

---
count: false
 
# Question 3 (3): County death ratio
.left-panel-q33-auto[

```r
covid %&gt;%  
* filter(date == max(date), cases &gt; 1000, county != "Unknown")
```
]
 
.right-panel-q33-auto[

```
# A tibble: 669 x 6
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Calhoun  Alabama 01015  1883     17
 4 2020-08-10 Colbert  Alabama 01033  1234     16
 5 2020-08-10 Cullman  Alabama 01043  1312     12
 6 2020-08-10 Dallas   Alabama 01047  1423     23
 7 2020-08-10 DeKalb   Alabama 01049  1889     16
 8 2020-08-10 Elmore   Alabama 01051  1808     39
 9 2020-08-10 Escambia Alabama 01053  1199     17
10 2020-08-10 Etowah   Alabama 01055  2232     33
# … with 659 more rows
```
]

---
count: false
 
# Question 3 (3): County death ratio
.left-panel-q33-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 1000, county != "Unknown") %&gt;%  
* mutate(ratio = 100*(deaths/cases))
```
]
 
.right-panel-q33-auto[

```
# A tibble: 669 x 7
   date       county   state   fips  cases deaths ratio
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22 1.80 
 2 2020-08-10 Baldwin  Alabama 01003  3714     28 0.754
 3 2020-08-10 Calhoun  Alabama 01015  1883     17 0.903
 4 2020-08-10 Colbert  Alabama 01033  1234     16 1.30 
 5 2020-08-10 Cullman  Alabama 01043  1312     12 0.915
 6 2020-08-10 Dallas   Alabama 01047  1423     23 1.62 
 7 2020-08-10 DeKalb   Alabama 01049  1889     16 0.847
 8 2020-08-10 Elmore   Alabama 01051  1808     39 2.16 
 9 2020-08-10 Escambia Alabama 01053  1199     17 1.42 
10 2020-08-10 Etowah   Alabama 01055  2232     33 1.48 
# … with 659 more rows
```
]

---
count: false
 
# Question 3 (3): County death ratio
.left-panel-q33-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 1000, county != "Unknown") %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
* slice_max(ratio, n = 5)
```
]
 
.right-panel-q33-auto[

```
# A tibble: 5 x 7
  date       county    state       fips  cases deaths ratio
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 2020-08-10 Sussex    New Jersey  34037  1370    198  14.5
2 2020-08-10 Middlesex Connecticut 09007  1405    192  13.7
3 2020-08-10 Warren    New Jersey  34041  1359    172  12.7
4 2020-08-10 Morris    New Jersey  34027  7409    829  11.2
5 2020-08-10 Hartford  Connecticut 09003 12800   1415  11.1
```
]

---
count: false
 
# Question 3 (3): County death ratio
.left-panel-q33-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 1000, county != "Unknown") %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
  slice_max(ratio, n = 5) %&gt;%  
* pull(county, state)
```
]
 
.right-panel-q33-auto[

```
 New Jersey Connecticut  New Jersey  New Jersey Connecticut 
   "Sussex" "Middlesex"    "Warren"    "Morris"  "Hartford" 
```
]

---
count: false
 
# Question 3 (3): County death ratio
.left-panel-q33-auto[

```r
covid %&gt;%  
  filter(date == max(date), cases &gt; 1000, county != "Unknown") %&gt;%  
  mutate(ratio = 100*(deaths/cases)) %&gt;%  
  slice_max(ratio, n = 5) %&gt;%  
  pull(county, state)  
```
]
 
.right-panel-q33-auto[

```
 New Jersey Connecticut  New Jersey  New Jersey Connecticut 
   "Sussex" "Middlesex"    "Warren"    "Morris"  "Hartford" 
```
]

&lt;style&gt;
.left-panel-q33-auto {
  color: #777;
  width: 58.8235294117647%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-q33-auto {
  width: 39.2156862745098%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-q33-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
*covid
```
]
 
.right-panel-q4-auto[

```
# A tibble: 421,390 x 6
   date       county      state      fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-01-21 Snohomish   Washington 53061     1      0
 2 2020-01-22 Snohomish   Washington 53061     1      0
 3 2020-01-23 Snohomish   Washington 53061     1      0
 4 2020-01-24 Cook        Illinois   17031     1      0
 5 2020-01-24 Snohomish   Washington 53061     1      0
 6 2020-01-25 Orange      California 06059     1      0
 7 2020-01-25 Cook        Illinois   17031     1      0
 8 2020-01-25 Snohomish   Washington 53061     1      0
 9 2020-01-26 Maricopa    Arizona    04013     1      0
10 2020-01-26 Los Angeles California 06037     1      0
# … with 421,380 more rows
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
* filter(date == max(date))
```
]
 
.right-panel-q4-auto[

```
# A tibble: 3,221 x 6
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,211 more rows
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
* group_by(state)
```
]
 
.right-panel-q4-auto[

```
# A tibble: 3,221 x 6
# Groups:   state [55]
   date       county   state   fips  cases deaths
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2020-08-10 Autauga  Alabama 01001  1222     22
 2 2020-08-10 Baldwin  Alabama 01003  3714     28
 3 2020-08-10 Barbour  Alabama 01005   631      5
 4 2020-08-10 Bibb     Alabama 01007   450      5
 5 2020-08-10 Blount   Alabama 01009   947      4
 6 2020-08-10 Bullock  Alabama 01011   474     12
 7 2020-08-10 Butler   Alabama 01013   782     37
 8 2020-08-10 Calhoun  Alabama 01015  1883     17
 9 2020-08-10 Chambers Alabama 01017   909     38
10 2020-08-10 Cherokee Alabama 01019   304      9
# … with 3,211 more rows
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
* summarize(totCases = sum(cases), totDeaths = sum(deaths))
```
]
 
.right-panel-q4-auto[

```
# A tibble: 55 x 3
   state                totCases totDeaths
   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;
 1 Alabama                103020      1797
 2 Alaska                   4537        24
 3 Arizona                187634      4157
 4 Arkansas                50028       555
 5 California             574267     10460
 6 Colorado                51104      1868
 7 Connecticut             50567      4444
 8 Delaware                15634       591
 9 District of Columbia    12807       591
10 Florida                536953      8276
# … with 45 more rows
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(totCases = sum(cases), totDeaths = sum(deaths)) %&gt;%  
* ungroup()
```
]
 
.right-panel-q4-auto[

```
# A tibble: 55 x 3
   state                totCases totDeaths
   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;
 1 Alabama                103020      1797
 2 Alaska                   4537        24
 3 Arizona                187634      4157
 4 Arkansas                50028       555
 5 California             574267     10460
 6 Colorado                51104      1868
 7 Connecticut             50567      4444
 8 Delaware                15634       591
 9 District of Columbia    12807       591
10 Florida                536953      8276
# … with 45 more rows
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(totCases = sum(cases), totDeaths = sum(deaths)) %&gt;%  
  ungroup() %&gt;%  
* mutate(ratio = 100 * (totDeaths/totCases))
```
]
 
.right-panel-q4-auto[

```
# A tibble: 55 x 4
   state                totCases totDeaths ratio
   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Alabama                103020      1797 1.74 
 2 Alaska                   4537        24 0.529
 3 Arizona                187634      4157 2.22 
 4 Arkansas                50028       555 1.11 
 5 California             574267     10460 1.82 
 6 Colorado                51104      1868 3.66 
 7 Connecticut             50567      4444 8.79 
 8 Delaware                15634       591 3.78 
 9 District of Columbia    12807       591 4.61 
10 Florida                536953      8276 1.54 
# … with 45 more rows
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(totCases = sum(cases), totDeaths = sum(deaths)) %&gt;%  
  ungroup() %&gt;%  
  mutate(ratio = 100 * (totDeaths/totCases)) %&gt;%  
* slice_max(ratio, n = 5)
```
]
 
.right-panel-q4-auto[

```
# A tibble: 5 x 4
  state         totCases totDeaths ratio
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Connecticut      50567      4444  8.79
2 New Jersey      186884     15878  8.50
3 New York        426046     32361  7.60
4 Massachusetts   121315      8741  7.21
5 Michigan         97472      6527  6.70
```
]

---
count: false
 
# Question 4: State death ratio
.left-panel-q4-auto[

```r
covid %&gt;%  
  filter(date == max(date)) %&gt;%  
  group_by(state) %&gt;%  
  summarize(totCases = sum(cases), totDeaths = sum(deaths)) %&gt;%  
  ungroup() %&gt;%  
  mutate(ratio = 100 * (totDeaths/totCases)) %&gt;%  
  slice_max(ratio, n = 5) %&gt;%  
* pull(ratio, state)
```
]
 
.right-panel-q4-auto[

```
  Connecticut    New Jersey      New York Massachusetts      Michigan 
     8.788340      8.496179      7.595659      7.205210      6.696282 
```
]

&lt;style&gt;
.left-panel-q4-auto {
  color: #777;
  width: 58.8235294117647%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-q4-auto {
  width: 39.2156862745098%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-q4-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
class: center, middle

&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/jbkSRLYSojo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;

---
class: middle, center, inverse
# Data Visualization
---
# ggplot

- `ggplot2` is a library is based on the **grammar of graphics**

--

- the idea is you can build every graph from the same
few components: 
  1. a data set 
  2. geom(s)
  3. a coordinate system

--

- `ggplot2` provides a programmatic interface for specifying
 - what variables to plot, 
 - how they are displayed, 
 - general visual properties. 
 
--

- Therefore, we only need _minimal_ changes if the underlying data changes or if we decide to change our visual.

- This helps create publication quality plots with minimal amounts of adjustments and tweaking.

--

- ggplot likes data in the ‘long’ format: i.e., a column for every dimension, and a row for every observation. (more on this tommorrow!!)

---

# Components of a ggplot:

- ggplot graphics are built step by step by adding new elements and layers

--

  1. Data
  2. Geometry (geom)
  3. Aesthetic mapping
  4. Theme

--

- Elements of a plot are layered by iteritavly adding elements 

--

- These can be added in a series of 5 steps:

1. Setup
2. Layers
3. Labels
4. Facets
5. Themes

---

# Example Data for today ...


```r
(gm2007 = filter(gapminder, year == 2007))
```

```
# A tibble: 142 x 6
   country     continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       2007    43.8  31889923      975.
 2 Albania     Europe     2007    76.4   3600523     5937.
 3 Algeria     Africa     2007    72.3  33333216     6223.
 4 Angola      Africa     2007    42.7  12420476     4797.
 5 Argentina   Americas   2007    75.3  40301927    12779.
 6 Australia   Oceania    2007    81.2  20434176    34435.
 7 Austria     Europe     2007    79.8   8199783    36126.
 8 Bahrain     Asia       2007    75.6    708573    29796.
 9 Bangladesh  Asia       2007    64.1 150448339     1391.
10 Belgium     Europe     2007    79.4  10392226    33693.
# … with 132 more rows
```

---

# 1. The Setup: canvas

.pull-left[
An empty canvas can be initialized with `ggplot()`
]

.pull-right[

```r
ggplot()
```

&lt;img src="lecture-06_files/figure-html/unnamed-chunk-7-1.png" width="432" /&gt;
]

---

# 1. The Setup: data

.pull-left[
- Every ggplot requires a data argument (data.frame/tibble)
]

.pull-right[

```r
ggplot(data = gm2007)
```

&lt;img src="lecture-06_files/figure-html/unnamed-chunk-8-1.png" width="432" /&gt;
]

---

# 1. The Setup: Aesthetic Mappings

.pull-left[
- Aesthetic mappings describe how variables in the `data` are visualized

- Denoted by the `aes` argument  

- Aesthetic mappings can be set in ggplot() and/or in individual layers.

- Aesthetic mappings in the ggplot() call, can be seen by all geom layers. 

- The X and Y axis of the plot as well colors, sizes, shapes, fills are all aesthetic. 

- If you want to have an aesthetic fixed (that is **not** vary based on a variable) you need to specify it _outside_ the aes()
]

.pull-right[


```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp))
```

&lt;img src="lecture-06_files/figure-html/unnamed-chunk-9-1.png" width="432" /&gt;
]

---

# 2. Layers

- The `+` sign is used to add layers to a `ggplot` setup

--

- Layers can define geometries, compute summary statistics, define what scales to use, or even change styles. 

--

- In general a plot construction will look like this:


```r
DATA %&gt;% 
  ggplot(aes(x, y)) + 
  LAYER 1 + 
  LAYER 2 + 
  … 
```

---

# 2. Layers: Geometry

- Many layers in `ggplot2` are called ‘geoms’. 

--

- `geoms` are the geometric objects (points, lines, bars, etc.) that can be placed on a graph to visualize the `X-Y mapping` of the input `data`

--

- They are called using functions that start with `geom_*`. 

--

- Examples include:
  - points (`geom_point`, for scatter plots, dot plots, etc)
  - lines (`geom_line`, for time series, trend lines, etc)
  - boxplots (`geom_boxplot`)
  - … and many more!
  

```
 [1] "geom_abline"         "geom_area"           "geom_bar"           
 [4] "geom_bin2d"          "geom_blank"          "geom_boxplot"       
 [7] "geom_col"            "geom_contour"        "geom_contour_filled"
[10] "geom_count"          "geom_crossbar"       "geom_curve"         
[13] "geom_density"        "geom_density_2d"     "geom_density2d"     
[16] "geom_dotplot"        "geom_errorbar"       "geom_errorbarh"     
[19] "geom_freqpoly"       "geom_hex"            "geom_histogram"     
[22] "geom_hline"          "geom_jitter"         "geom_label"         
[25] "geom_line"           "geom_linerange"      "geom_map"           
[28] "geom_path"           "geom_point"          "geom_pointrange"    
[31] "geom_polygon"        "geom_qq"             "geom_qq_line"       
[34] "geom_quantile"       "geom_raster"         "geom_rect"          
[37] "geom_ribbon"         "geom_rug"            "geom_segment"       
[40] "geom_sf"             "geom_sf_label"       "geom_sf_text"       
[43] "geom_smooth"         "geom_spoke"          "geom_step"          
[46] "geom_text"           "geom_tile"           "geom_violin"        
[49] "geom_vline"         
```
  
  
---

# 2. Layers: Geometry

- A plot **must** have at least one geom, but there is no maximum.

--

- Adding geoms to a ggplot follows the pattern:


```r
ggplot(data = &lt;DATA&gt;, aes(X, Y)) + 
  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))
  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))
```

- Note again that the aesthetics placed in the `ggplot` call are the **global** parameters for the plot, and the aethetics placed in each `geom` are specific to that `geom`.

---

count: false
 
# A first geom_* ...
.left-panel-geom1-auto[

```r
*ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-geom1-auto[
&lt;img src="lecture-06_files/figure-html/geom1_auto_1_output-1.png" width="432" /&gt;
]

---
count: false
 
# A first geom_* ...
.left-panel-geom1-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
* geom_point()
```
]
 
.right-panel-geom1-auto[
&lt;img src="lecture-06_files/figure-html/geom1_auto_2_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-geom1-auto {
  color: #777;
  width: 58.8235294117647%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-geom1-auto {
  width: 39.2156862745098%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-geom1-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---

# 2. Layers: Geometry

.pull-left[
Like the set up, `geoms` can be modified with aesthetics (`aes`). Examples include:

- position (i.e., on the x and y axes)
- color (“outside” color)
- fill (“inside” color)
- shape
- line type
- size

Each `geom` accepts only a **subset** of these aesthetics

(refer to the `geom` help pages (e.g. `?geom_point`) to see what mappings each `geom` accepts. 
]

.pull-right[
&lt;img src="lec-img/06-geom-point.png" width="75%"&gt;
]

---
# 2. Layers: data.frame driven or fixed?

.pull-left[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) + 
  geom_point(col = "red")
```

&lt;img src="lecture-06_files/figure-html/unnamed-chunk-13-1.png" width="432" /&gt;
]

.pull-right[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) + 
  geom_point(aes(col = continent))
```

&lt;img src="lecture-06_files/figure-html/unnamed-chunk-14-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-geoms-auto[

```r
*ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-geoms-auto[
&lt;img src="lecture-06_files/figure-html/geoms_auto_1_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-geoms-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
* geom_point(aes(color = continent, size = pop))
```
]
 
.right-panel-geoms-auto[
&lt;img src="lecture-06_files/figure-html/geoms_auto_2_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-geoms-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
* geom_smooth(color = "black")
```
]
 
.right-panel-geoms-auto[
&lt;img src="lecture-06_files/figure-html/geoms_auto_3_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-geoms-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black") +  
* geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray")
```
]
 
.right-panel-geoms-auto[
&lt;img src="lecture-06_files/figure-html/geoms_auto_4_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-geoms-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black") +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
* geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray")
```
]
 
.right-panel-geoms-auto[
&lt;img src="lecture-06_files/figure-html/geoms_auto_5_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-geoms-auto {
  color: #777;
  width: 49.0196078431373%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-geoms-auto {
  width: 49.0196078431373%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-geoms-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---

# 3. Labels

- Now that you have drawn the main parts of the graph. You might want to add labs that clarify what is being shown. 

--

- This can be done using the `labs` layer. 

--

- The most typical are: `title`, `x`, and `y` but other options exist!

---

count: false
 
# For our example...
.left-panel-labs-auto[

```r
*ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-labs-auto[
&lt;img src="lecture-06_files/figure-html/labs_auto_1_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-labs-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
* geom_point(aes(color = continent, size = pop))
```
]
 
.right-panel-labs-auto[
&lt;img src="lecture-06_files/figure-html/labs_auto_2_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-labs-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
* geom_smooth(color = "black", size = .5)
```
]
 
.right-panel-labs-auto[
&lt;img src="lecture-06_files/figure-html/labs_auto_3_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-labs-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
* geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray")
```
]
 
.right-panel-labs-auto[
&lt;img src="lecture-06_files/figure-html/labs_auto_4_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-labs-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
* geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray")
```
]
 
.right-panel-labs-auto[
&lt;img src="lecture-06_files/figure-html/labs_auto_5_output-1.png" width="432" /&gt;
]

---
count: false
 
# For our example...
.left-panel-labs-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
  geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray") +  
* labs(title = "Per capita GDP versus life expectency in 2007",
*      x = "Per Capita GDP",
*      y = "Life Expectancy",
*      caption = "Based on Hans Rosling Plots",
*      subtitle = 'Data Source: Gapminder',
*      color = "",
*      size = "Population")
```
]
 
.right-panel-labs-auto[
&lt;img src="lecture-06_files/figure-html/labs_auto_6_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-labs-auto {
  color: #777;
  width: 49.0196078431373%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-labs-auto {
  width: 49.0196078431373%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-labs-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---
# 4. Facets

- In the previous chart, we showed a scatterplot for all countries plotted in the same chart. What if you want one chart for each continent?

--

- Such separation is called `faceting`

--

- `facet_wrap()` takes in a formula as the argument. 

- Formulas look like this `RHS ~ LHS` (where RHS = right hand side, LHS = left hand side)

The item on the RHS corresponds to the column. The item on the LHS defines the rows.

--

- In `facet_wrap`, the scales of the X and Y axis are fixed to accommodate **all** points by default. 

- This makes the comparison of values more meaningful because they would be in the same scale.

- The scales can be made `free` by setting the argument `scales=free`.

---

count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
*ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_1_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
* geom_point(aes(color = continent, size = pop))
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_2_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
* geom_smooth(color = "black", size = .5)
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_3_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
* geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray")
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_4_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
* geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray")
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_5_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
  geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray") +  
* labs(title = "Per capita GDP versus life expectency in 2007",
*      x = "Per Capita GDP",
*      y = "Life Expectancy",
*      caption = "Based on Hans Rosling Plots",
*      subtitle = 'Data Source: Gapminder',
*      color = "",
*      size = "Population")
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_6_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
  geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray") +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
* facet_wrap(~continent)
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_7_output-1.png" width="432" /&gt;
]

---
count: false
 
# Facet Wrap...
.left-panel-facet-auto[

```r
ggplot(data = gm2007, aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  geom_smooth(color = "black", size = .5) +  
  geom_hline(yintercept = mean(gm2007$lifeExp), color = "gray") +  
  geom_vline(xintercept = mean(gm2007$gdpPercap), color = "gray") +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  facet_wrap(~continent) +  
* facet_wrap(~continent, scales = "free")
```
]
 
.right-panel-facet-auto[
&lt;img src="lecture-06_files/figure-html/facet_auto_8_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-facet-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-facet-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-facet-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
*gapminder
```
]
 
.right-panel-grid-auto[

```
# A tibble: 1,704 x 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# … with 1,694 more rows
```
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
* filter(year %in% c(1952, 1977, 2007))
```
]
 
.right-panel-grid-auto[

```
# A tibble: 426 x 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1977    38.4 14880372      786.
 3 Afghanistan Asia       2007    43.8 31889923      975.
 4 Albania     Europe     1952    55.2  1282697     1601.
 5 Albania     Europe     1977    68.9  2509048     3533.
 6 Albania     Europe     2007    76.4  3600523     5937.
 7 Algeria     Africa     1952    43.1  9279525     2449.
 8 Algeria     Africa     1977    58.0 17152804     4910.
 9 Algeria     Africa     2007    72.3 33333216     6223.
10 Angola      Africa     1952    30.0  4232095     3521.
# … with 416 more rows
```
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
  filter(year %in% c(1952, 1977, 2007)) %&gt;%  
* ggplot(aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-grid-auto[
&lt;img src="lecture-06_files/figure-html/grid_auto_3_output-1.png" width="432" /&gt;
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
  filter(year %in% c(1952, 1977, 2007)) %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
* geom_point(aes(size = pop))
```
]
 
.right-panel-grid-auto[
&lt;img src="lecture-06_files/figure-html/grid_auto_4_output-1.png" width="432" /&gt;
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
  filter(year %in% c(1952, 1977, 2007)) %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(size = pop)) +  
* labs(title = "Per capita GDP versus life expectency in 2007",
*      x = "Per Capita GDP",
*      y = "Life Expectancy",
*      caption = "Based on Hans Rosling Plots",
*      subtitle = 'Data Source: Gapminder',
*      color = "",
*      size = "Population")
```
]
 
.right-panel-grid-auto[
&lt;img src="lecture-06_files/figure-html/grid_auto_5_output-1.png" width="432" /&gt;
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
  filter(year %in% c(1952, 1977, 2007)) %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
* facet_wrap(year~continent)
```
]
 
.right-panel-grid-auto[
&lt;img src="lecture-06_files/figure-html/grid_auto_6_output-1.png" width="432" /&gt;
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
  filter(year %in% c(1952, 1977, 2007)) %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  facet_wrap(year~continent) +  
* facet_grid(year~continent)
```
]
 
.right-panel-grid-auto[
&lt;img src="lecture-06_files/figure-html/grid_auto_7_output-1.png" width="432" /&gt;
]

---
count: false
 
#Facet Grids...
.left-panel-grid-auto[

```r
gapminder %&gt;%  
  filter(year %in% c(1952, 1977, 2007)) %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  facet_wrap(year~continent) +  
  facet_grid(year~continent) +  
* facet_grid(continent~year)
```
]
 
.right-panel-grid-auto[
&lt;img src="lecture-06_files/figure-html/grid_auto_8_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-grid-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-grid-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-grid-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# 5. Theme

- Great! Now we just need to polish our plots...

--

- ggplot offers a themeing system:

--

1.  `elements` specify the non-data elements that you can control. For example, 
  -  `plot.title` controls the appearance of the plot title; 
  - ` axis.ticks.x` controls the ticks on the x axis; 
  - `legend.key.height`, controls the height of the keys in the legend.

--

2. Each `element` is associated with an element function, which describes the visual properties. For example, 
  - `element_text()` sets the font size, color and face of text elements like `plot.title`.

-- 

3. The `theme()` function which allows you to override  default elements:
   - For example  `theme(plot.title = element_text(color = "red"))`.

---

# Built in themes

Wow! Thats a lot :) Fortunately, ggplot comes with many default themes that set all of the theme elements to values designed to work together harmoniously.


```
 [1] "theme_bw"       "theme_classic"  "theme_dark"     "theme_get"     
 [5] "theme_gray"     "theme_grey"     "theme_light"    "theme_linedraw"
 [9] "theme_minimal"  "theme_replace"  "theme_set"      "theme_test"    
[13] "theme_update"   "theme_void"    
```

---

# theme_bw()


```r
theme_bw
```

```
function (base_size = 11, base_family = "", base_line_size = base_size/22, 
    base_rect_size = base_size/22) 
{
    theme_grey(base_size = base_size, base_family = base_family, 
        base_line_size = base_line_size, base_rect_size = base_rect_size) %+replace% 
        theme(panel.background = element_rect(fill = "white", 
            colour = NA), panel.border = element_rect(fill = NA, 
            colour = "grey20"), panel.grid = element_line(colour = "grey92"), 
            panel.grid.minor = element_line(size = rel(0.5)), 
            strip.background = element_rect(fill = "grey85", 
                colour = "grey20"), legend.key = element_rect(fill = "white", 
                colour = NA), complete = TRUE)
}
&lt;bytecode: 0x7fa0c4c76e58&gt;
&lt;environment: namespace:ggplot2&gt;
```

---

count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
*gm2007
```
]
 
.right-panel-theme-auto[

```
# A tibble: 142 x 6
   country     continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       2007    43.8  31889923      975.
 2 Albania     Europe     2007    76.4   3600523     5937.
 3 Algeria     Africa     2007    72.3  33333216     6223.
 4 Angola      Africa     2007    42.7  12420476     4797.
 5 Argentina   Americas   2007    75.3  40301927    12779.
 6 Australia   Oceania    2007    81.2  20434176    34435.
 7 Austria     Europe     2007    79.8   8199783    36126.
 8 Bahrain     Asia       2007    75.6    708573    29796.
 9 Bangladesh  Asia       2007    64.1 150448339     1391.
10 Belgium     Europe     2007    79.4  10392226    33693.
# … with 132 more rows
```
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
* ggplot(aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_2_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
* geom_point(aes(color = continent, size = pop))
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_3_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
* labs(title = "Per capita GDP versus life expectency in 2007",
*      x = "Per Capita GDP",
*      y = "Life Expectancy",
*      caption = "Based on Hans Rosling Plots",
*      subtitle = 'Data Source: Gapminder',
*      color = "",
*      size = "Population")
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_4_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
* theme_bw()
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_5_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  theme_bw() +  
* theme_dark()
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_6_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  theme_bw() +  
  theme_dark() +  
* theme_gray()
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_7_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  theme_bw() +  
  theme_dark() +  
  theme_gray() +  
* theme_minimal()
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_8_output-1.png" width="432" /&gt;
]

---
count: false
 
#Built in Themes...
.left-panel-theme-auto[

```r
gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  theme_bw() +  
  theme_dark() +  
  theme_gray() +  
  theme_minimal() +  
* theme_light()
```
]
 
.right-panel-theme-auto[
&lt;img src="lecture-06_files/figure-html/theme_auto_9_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-theme-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-theme-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-theme-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---

count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
*library(ggthemes)
```
]
 
.right-panel-ggtheme-auto[

]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

*gm2007
```
]
 
.right-panel-ggtheme-auto[

```
# A tibble: 142 x 6
   country     continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       2007    43.8  31889923      975.
 2 Albania     Europe     2007    76.4   3600523     5937.
 3 Algeria     Africa     2007    72.3  33333216     6223.
 4 Angola      Africa     2007    42.7  12420476     4797.
 5 Argentina   Americas   2007    75.3  40301927    12779.
 6 Australia   Oceania    2007    81.2  20434176    34435.
 7 Austria     Europe     2007    79.8   8199783    36126.
 8 Bahrain     Asia       2007    75.6    708573    29796.
 9 Bangladesh  Asia       2007    64.1 150448339     1391.
10 Belgium     Europe     2007    79.4  10392226    33693.
# … with 132 more rows
```
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
* ggplot(aes(x = gdpPercap, y = lifeExp))
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_3_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
* geom_point(aes(color = continent, size = pop))
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_4_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
* labs(title = "Per capita GDP versus life expectency in 2007",
*      x = "Per Capita GDP",
*      y = "Life Expectancy",
*      caption = "Based on Hans Rosling Plots",
*      subtitle = 'Data Source: Gapminder',
*      color = "",
*      size = "Population")
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_5_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
* ggthemes::theme_stata()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_6_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
* ggthemes::theme_economist()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_7_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
  ggthemes::theme_economist() +  
* ggthemes::theme_economist_white()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_8_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
  ggthemes::theme_economist() +  
  ggthemes::theme_economist_white() +  
* ggthemes::theme_fivethirtyeight()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_9_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
  ggthemes::theme_economist() +  
  ggthemes::theme_economist_white() +  
  ggthemes::theme_fivethirtyeight() +  
* ggthemes::theme_gdocs()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_10_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
  ggthemes::theme_economist() +  
  ggthemes::theme_economist_white() +  
  ggthemes::theme_fivethirtyeight() +  
  ggthemes::theme_gdocs() +  
* ggthemes::theme_excel()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_11_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
  ggthemes::theme_economist() +  
  ggthemes::theme_economist_white() +  
  ggthemes::theme_fivethirtyeight() +  
  ggthemes::theme_gdocs() +  
  ggthemes::theme_excel() +  
* ggthemes::theme_wsj()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_12_output-1.png" width="432" /&gt;
]

---
count: false
 
#ggtheme package...
.left-panel-ggtheme-auto[

```r
library(ggthemes)  

gm2007 %&gt;%  
  ggplot(aes(x = gdpPercap, y = lifeExp)) +  
  geom_point(aes(color = continent, size = pop)) +  
  labs(title = "Per capita GDP versus life expectency in 2007",  
       x = "Per Capita GDP",  
       y = "Life Expectancy",  
       caption = "Based on Hans Rosling Plots",  
       subtitle = 'Data Source: Gapminder',  
       color = "",  
       size = "Population") +  
  ggthemes::theme_stata() +  
  ggthemes::theme_economist() +  
  ggthemes::theme_economist_white() +  
  ggthemes::theme_fivethirtyeight() +  
  ggthemes::theme_gdocs() +  
  ggthemes::theme_excel() +  
  ggthemes::theme_wsj() +  
* ggthemes::theme_hc()
```
]
 
.right-panel-ggtheme-auto[
&lt;img src="lecture-06_files/figure-html/ggtheme_auto_13_output-1.png" width="432" /&gt;
]

&lt;style&gt;
.left-panel-ggtheme-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-ggtheme-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-ggtheme-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




---

# Saving a ggplot element...

 - Remember that in R, we assign object to names. We have seen examples including values, data structures, and functions:

--

```r
x = 10 
class(x)
```

```
[1] "numeric"
```

--

 - ggplot outputs are also objects!


```r
gg = ggplot()
class(gg)
```

```
[1] "gg"     "ggplot"
```

```r
lobstr::obj_addr(gg)
```

```
[1] "0x7fa0c6106638"
```

---
# ggsave()

- ggplot comes with a function ggsave, that write a gg object to a file path (with path, name, extension)

```r
ggsave(gg, file = "img/my-beatuiful-plot.png")

# or #

gg %&gt;% 
  ggsave(file = "img/my-beatuiful-plot.png", 
         width = 8, 
         units = c("in"))
```

---

# Assignment

In your `geog176A-daily-exercises`
1. Make a new `R` directory (mkdir R from the parent directory)
2. Create a new R file called day-06.R (touch R/day-06.R)
3. Open that file. 
  - This is an R script. Unlike Rmarkdown it will not knit, but unlike the console, it will save and keep your code. 
4. In this file add your name, date, and the purpose of the script as comments (preceded by #)
5. Now, read in the COVID-19 data from the URL like yesterday

***

---


**Question 1**: Make a _faceted_ line plot (*geom_line*) of the **6** states with **most** cases. Your X axis should be the _date_ and the y axis _cases_.

We can break this task into 4 steps:

 1. Identify the six states with the most current cases (yesterdays assignment + `pull`)
 2. Filter the raw data to those 6 states (hint: `%in%`)
 3. Set up a ggplot --&gt; add layers --&gt; add labels --&gt; add a facet --&gt; add a theme
 4. save the image to you `img` directory (hint: `ggsave()`)

***
&lt;center&gt;
&lt;img src="lec-img/06-question-01.png" width = "35%"&gt;
&lt;/center&gt;
---

**Question 2**: Make a column plot (`geom_col`) of daily total cases in the **USA**. Your X axis should be the _date_ and the y axis _cases_.
 
We can break this task into 3 steps:

 1. Identify the total cases each day in the whole country (hint: `group_by(date)`)
 2. Set up a ggplot --&gt; add layers --&gt; add labels --&gt; add a theme
 3. Save the image to your `img` directory (hint: `ggsave()`)

*** 

&lt;center&gt;
&lt;img src="lec-img/06-question-02.png" width = "35%"&gt;
&lt;/center&gt;

---
class: middle, center
# Submission:

Turn in your Rscript, and 2 images to the Gauchospace dropbox

---

# END
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:10",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
